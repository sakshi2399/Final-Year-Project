{% extends "base.html" %}
{% block appointment %} active {% endblock appointment %}
{% load static %}
{% block content %}
<head>
  <link href="{%static 'assets_presc/style.css' %}" rel="stylesheet">
  <link rel="shortcut icon" href="img/favicon.png">

  <title>Basic Table | Creative - Bootstrap 3 Responsive Admin Template</title>

  <!-- Bootstrap CSS -->
  <link href="{%static 'assets_appoint/css/bootstrap.min.css' %}" rel="stylesheet">
  <!-- bootstrap theme -->
  <link href="{%static 'assets_appoint/css/bootstrap-theme.css' %}" rel="stylesheet">
  <!--external css-->
  <!-- font icon -->
  <link href="{%static 'assets_appoint/css/elegant-icons-style.css' %}" rel="stylesheet" />
  <link href="{%static 'assets_appoint/css/font-awesome.min.css' %}" rel="stylesheet" />
  <!-- Custom styles -->
  <link href="{%static 'assets_appoint/css/style.css' %}" rel="stylesheet">
  <link href="{%static 'assets_appoint/css/style-responsive.css' %}" rel="stylesheet" />
  <script>
    
    function show() { 
      // document.getElementById("active").disabled = true;
      
      var rowId =  event.target.parentNode.parentNode.id; 
              //this gives id of tr whose button was clicked 
                var data_name = document.getElementById(rowId).querySelectorAll(".dta");  
                // var data_mob = document.getElementById(rowId).querySelectorAll(".dta"); 
              // /*returns array of all elements with  
              // "row-data" class within the row with given id*/ 
  
                var name = data_name[0].innerHTML; 
                var mob = data_name[4].innerHTML
                // var date = data[1]; 
                document.getElementById("name_text").value=name;
                document.getElementById("mob_text").value=mob;
                document.getElementById("row_id").value=rowId;

                alert("rowid: " + rowId + "name:" + name +" mob: " + mob); 
                
                // document.getElementById("warning").disabled = false;
                // document.getElementById('warning').removeAttribute('disabled');
                return true;
            }
</script>
</head>
<body>
<script>
var options = { year: 'numeric', month: 'long', day: 'numeric' };
var today  = new Date();
var year   = today.getFullYear();
var month  = today.toLocaleString('default', { month: 'long' });
var date   = ("0" + today.getDate()).slice(-2);
var date1  = ("0" + (date+1)).slice(-2);
var date_today = month + " " + date + " " + "," + " " + year;
var date_tomorrow = month + " " + date1 + " " + "," + " " + year;
console.log(date_today)
var today1 = today.toLocaleDateString("en-US", options);

function yourfunction()
{
   /* do stuff on page load */ 
input=document.getElementById("appointment_date");
opts = '<option value="'+date_today+'">'+"Today"+'</option>'
'<option value="'+date_tomorrow+'">'+"Tomorrow"+'</option>';

input.innerHTML = opts; 

}

function searchdata()
{
var input,table,tr,td,filter,displaydate;
input=document.getElementById("appointment_date");
filter = input.value;
console.log(filter);
table = document.getElementById("table1");
tr = table.getElementsByTagName("tr");
input.innerHTML = opts;
for(i=0;i<tr.length;i++)
{
td=tr[i].getElementsByTagName("td")[1];
if(td)
{
  
  displaydate=td.innerText;
  console.log(displaydate);
  console.log(date_today);
  if(displaydate.localeCompare(filter)==0)

  {
    tr[i].style.display="";
  }
  else
  {
    tr[i].style.display="none";
  }

}

} 
}   


function someFunc() {
   yourfunction();
   searchdata();
}
</script>
 <!-- page start-->
 <br>
 <br>
 <br>
 <br>      
 <div class="row">
  <div class="col-lg-12">
    <section class="panel">
      <div class="section-title">
        <h2> Appointments </h2>
        
        

        <form action="/patient" method="post">
          
         
          
          <select id="appointment_date" name="appointment_date" onclick="someFunc();">
           <option disabled = "true" selected>Select date</option>
            <!-- <h1>{{ i.name }}</h1> -->
            
            
            <!-- <option value = $date_today >Today</option>
            <option value="">Tomorrow</option> -->
            
          </select>
          
        </form>
      </div>


      <table class="table table-striped table-advance table-hover" id ="table1">
        <tbody>
          <tr >
            <th><i class="icon_profile"></i> Full Name</th>
            <th><i class="icon_calendar"></i> Date</th>
            <th><i class="icon_mail_alt"></i> Email</th>
            <th><i class="icon_pin_alt"></i> Time Slot</th>
            <th><i class="icon_mobile"></i> Mobile</th>
            <th><i class="icon_cogs"></i> Action</th>
          </tr>
           <form method="POST" >
            <input type="hidden" id ="name_text" class="form_ip" name="name"  />
            <input type="hidden" id ="mob_text" class="form_ip" name="mob"  />
            <input type="hidden" id ="row_id" class="form_ip" name="row_id"  />

            {% for data_appoint in appointment %}  
            <tr id="{{forloop.counter}}">
            <td class="dta">{{data_appoint.patient_id.name}}</td>
            <td class="dta">{{data_appoint.datepublished}}</td>
            <td class="dta">{{data_appoint.patient_id.email}}</td>
            <td class="dta">{{data_appoint.timepublished}}</td>
            <td class="dta">{{data_appoint.mobile}}</td>
            <td>
              
              <!-- <div class="btn-group" > -->
                <!-- <input type="hidden" id ="url" class="form_ip" name="get_url_address_recording"  /> -->
               <!-- <input  id="active" type="submit" onclick="return show() " formaction="/action1.php" ></input> -->
               {% csrf_token %}
               <button class="icon_plus_alt2" id="active" onclick="return show()" formaction="start_appointment"></button>  
               <button class="icon_check_alt2" id="warning" onclick="return show()" formaction="stop_appointment"></button>
               <button class="icon_close_alt2" id="absent" onclick="return show()" formaction="no_show_appointment"></button>
             
                <!-- <a class="btn btn-primary" href="#"><i class="icon_plus_alt2"></i></a>
                <a class="btn btn-success" href="#"><i class="icon_check_alt2"></i></a>
                <a class="btn btn-danger" href="#"><i class="icon_close_alt2"></i></a> -->
              <!-- </div> -->
            </td>
          </tr>
          {% endfor %}
        </form>
        </tbody>
      </table>
    </section>
  </div>
</div>

<!-- page end-->
</section>
</section>
</body>
<!--main content end-->
{% endblock content %}